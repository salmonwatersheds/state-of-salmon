---
title: "PSF's State of Salmon Report: Methods & Results"
author: "Salmon Watersheds Program, Steph Peacock"
date: "`r format(Sys.time(), '%B %d, %Y')`"
bibliography: references.json
csl: canadian-journal-of-fisheries-and-aquatic-sciences.csl 
link-citations: true
header-includes:
   - \usepackage{draftwatermark}
output: 
 html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    number_sections: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Set colour palette for species
# sp_cols <- viridis(5)
# sp_cols <- c("#332288", "#44AA99", "#88CCEE", "#CC6677", "#882255", "#DDCC77") #https://davidmathlogic.com/colorblind
# names(sp_cols) <- c("Chinook", "Chum", "Coho", "Pink", "Sockeye", "Steelhead")

source("code/colours.R")

```

<head>
<meta name="robots" content="noindex">
</head>

<style type="text/css">

.watermark {
  opacity: 0.2;
  position: fixed;
  top: 50%;
  left: 50%;
  font-size: 500%;
  color: #000000;
}

.blackbox {
  padding: 1em;
  background: black;
  color: white;
  border: 2px solid orange;
  border-radius: 10px;
}
.center {
  text-align: center;
}

</style>


<div class="watermark">DRAFT</div>

# Overview 

Currently, there is no place where the public can readily find answers to general questions regarding the state of salmon in BC and the Yukon. It is difficult to find credible answers to questions such as:

* How are salmon populations doing? 
* What are the major factors influencing the state of salmon? 
* What is being done - and what could be done - to mitigate threats and recover salmon populations and the habitats they depend on?

This lack of publicly accessible information about the state of Pacific salmon and opens the door to misinformation that can hinder and harm our ability to conserve salmon. 

The [Pacific Salmon Foundation (PSF)](https://www.psf.ca) is developing an inaugural **State of Salmon** report, which will address these questions and be tailored to the questions of a salmon-informed public audience. The outputs will be updated regularly (e.g. annually or biennially) to reflect new data and changes to the state of Pacific salmon populations.

As part of the State of Salmon report, PSF's [Salmon Watersheds Program](https://www.salmonwatersheds.ca) is developing simple metrics to report on the status and trends in regional abundance for each species. This document outlines the data sources and analytical approach used to estimate time series of spawner abundance and total returns (including catch) for each species and region, as well as draft results. **This information is intended to be shared with external partners in order to garner feedback on preliminary results that will inform our approach moving forward.** Our analyses are ongoing, and the information here is subject to change on a regular basis, but we will endeavor to keep it up-to-date.

# Methods

## General Approach

We report spawner abundance for each of nine regions that represent all major Pacific salmon-bearing watersheds in Canada: Yukon, Transboundary, Haida Gwaii, Nass, Skeena,  Central Coast, Vancouver Island & Mainland Inlets, Fraser, and Columbia. These regions are also used to organize data in the [Pacific Salmon Explorer](https://www.salmonexplorer.ca). There are a relatively small number of Pacific salmon that spawn in the MacKenzie River basin in Arctic Canada that are currently not considered here.

We separate five species of Pacific salmon: Chinook, chum, coho, pink, and sockeye. We also report status of steelhead trout for regions where spawner data are are available and can reasonably be expanded to yield an estimate of regional abundance (Nass, Skeena, interior Fraser, and Columbia). When assessing biological status, pink salmon are often separated into even- and odd-year lineages due to their consistent 2-year life cycle. However, for the general overviews provided in State of Salmon we consider generational averages, which take the running average of even- and odd-year lineages for pink salmon. This approach of using generation running averages also smooths over dominant years for sockeye salmon, for which many populations display cyclic dominance. Shifts in dominance between even- and odd-year pink populations or declines in sub-dominant years of sockeye salmon are considered in a more nuanced way in our reporting when discussing how changes in abundance have been reflected in the diversity and distribution of each species within the region. 

For each of these species, where data are available, we construct an index of **spawner abundance** at the regional scale. We focus on spawner abundance because these data are more readily accessible and easily summarised at different spatial scales. Spawners represent the abundance of salmon available to reproduce and contribute to future generations, as well as to meet cultural and ecological needs within watersheds, and thus provides a measure of status relevant to communities and ecosystems. We recognize that commercial catch has historically been a substantial portion of salmon that return to the coast, and that ignoring declines in catch will underestimate the declines in overall salmon abundance. Therefore, we include information on **total return** (i.e. spawners plus catch) for species and regions with reliable data. **This assessment of the data landscape is ongoing, and one of the reasons why the results here should be considered preliminary.** 

We have strived to base our assessments on the best available data for each region and species. For example, stocks that are governed by international treaties may be monitored by the [Pacific Salmon Commission (PSC)](https://www.psc.org/), and tend to have reliable time series of abundance available at regional scales. These data sources are outlined in the [Region-Specific Data section](#region-specific-data). For species and regions where aggregate abundance is not reported by the PSC or DFO at the scale needed, we adapted our approach to make the best use of available data. In most cases, this meant expanding spawner abundance from stream-level estimates to get a regional scale index of spawner abundance using two types of expansion factors [@EnglishEtAl2016NorthCentralCoast]. This expansion process is described in the [Expansion Factors section](#expansion-factors).  

`R` code and data for the analyses described here are available on GitHub at https://github.com/salmonwatersheds/state-of-salmon.

## Region-Specific Data Sources

Here we describe specific data sources for the abundance of salmon and steelhead at the regional scale. 

### Yukon

The Canadian portion of the Yukon River is home to Chinook, chum, and coho salmon. Border escapement and total return of Canadian-origin Chinook and fall chum salmon in the mainstem Yukon River are counted at the Eagle Sonar station on the Yukon/Alaska border, and are available from the [Yukon River Panel](https://www.yukonriverpanel.com/) in their Joint Technical Committee (JTC) Reports. Specifically, we used Chinook `Spawning escapement estimate` and `Canadian origin total run size estimate` from Appendix B11 of @JTC2023YukonRiverSalmon. Chum salmon spawner data were from Appendix B16 and total return from Appendix B20 of @JTC2023YukonRiverSalmon. Estimates from 2023 have not yet been published but were reported in the January 2024 post-season Yukon River Panel meeting (recording available on the YRP website [here](https://www.yukonriverpanel.com/meetings/past-meetings/)), and should be considered preliminary. 

There are also Chinook, chum, and coho salmon in the Canadian portion of the Porcupine River, which joins the mainstem Yukon River in Alaska. Data on escapement to the Porcupine River are more patchy and not currently included here.

<!-- ```{r, echo = FALSE, include = TRUE, fig.cap = "**Above:** Map showing the Canadian portino of the Yukon River drainage. Out estimates of spawner abundance and total return are based on border escapement estimated from Eagle sonar. Enuneration of salmon in the Porcupine river is less consistent and was not included in our analysis."} -->

<!-- ``` -->

### Transboundary

For Chinook, coho, and sockeye, we assessed regional abundance in the Transboundary using estimates of border escapement provided in the PSC's [Joint Transboundary Technical Committee Reports](https://www.psc.org/publications/technical-reports/technical-committee-reports/transboundary/). The regional spawner abundance and total return of Chinook was calculated as the sum of escapement and total return, respectively, to the Stikine, Alsek, and Taku watersheds, available from Table B2 of @CTC2023AnnualReportCatch and provided to PSF staff (E. Hertz) in Excel format following a data request to PSC's Chinook Technical Committee. Sockeye spawner abundance and total return was the `sum escapement` and `Terminal Run`, respectively, from the Stikine River [Appendix B21; @TTC2022FinalEstimatesTransboundary] and the Taku River [Appendix D15; @TTC2022FinalEstimatesTransboundary]. Coho spawner abundance and total return are available for the Taku River only, taken from Appendix D20 of @TTC2022FinalEstimatesTransboundary. The most recent TTC report [@TTC2022FinalEstimatesTransboundary] includes data through 2021, and updated Appendices with data through 2023 were provided to PSF staff on request to Aaron Foos (DFO).

Pink and chum salmon are less extensively monitored in the Transboundary, with ongoing escapement available only from the Canyon Island fish wheel on the Taku River. We used the index of escapement from the Canyon Island fish wheel as an index of regional spawner abundance for pink and chum [@TTC2022FinalEstimatesTransboundary]. There are some historical data for pink salmon spawner abundance in the Nakina River of the Taku watershed, but this location has not reported data since 1998 and thus we did not include this stream survey in our index of regional abundance. 

Steelhead trout have also been enumerated at the Canyon Island fish wheel since 1987, though recent estimates have been patchy and the timing of the fish wheel likely misses a substantial portion of the Taku summer run steelhead. Thus, we do not use the Canyon Island counts as an index of steelhead abundance.

We recognize that our approach in the Transboundary lacks information from many un-monitored watersheds, in particular the smaller watersheds of the Chilkat, Unuk, and Whiting Rivers. In the absence of better monitoring, we choose to report available data as a proxy for regional abundance, and note that the contribution of these smaller watersheds to total regional abundance for each species is likely small. 

### Haida Gwaii

For Haida Gwaii, we followed the [Expansion Factors](#expansion-factors) approach described below, with the exception of Chinook salmon for which the only data are from a single enumeration project on the Yakoun River. We show Yakoun River spawner abundance up to 2006, but no estimates were available for the most recent generation making the current status for Haida Gwaii Chinook "Unknown". For other species, we compared our expansion approach to estimates of escapement to Area 1 reported in the @TCNB2023CanadaNorthernBoundary (Appendix 30) but found the Area 1 estimates were much lower (except for Chinook, for which Appendix 30 matched the Yakoun River estimates exactly). 

### Nass

Chinook spawners and total return were taken from the [PSC's Chinook Technical Committee (CTC) data sets](https://www.psc.org/publications/technical-reports/technical-committee-reports/chinook/ctc-data-sets/) and are reported on in @CTC2023AnnualReportCatch. Specifically, Nass River (Area 3) escapement and terminal run are provided in Table B3 (fields `Esc` and `t.run` respectively).

Chum and pink salmon were expanded from available spawner surveys, as described below in [Expansion Factors](#expansion-factors). Note that the designation of indicator streams for the Nass region was based on @EnglishEtAl2018NorthCentralCoast rather than the indicator designation in NuSEDS.

Nass coho escapement and total return were reconstructed by @EnglishEtAl2023PreliminaryAreaSalmon for each of the three coho Conservation Units in the Nass region for 1992-2022. We summed the total escapement (`TE`) and total return (`Total Run`) across these three Conservation Units to yield the regional aggregate abundance.

Nass sockeye escapement and total return were derived from the Northern Boundary Sockeye Run Reconstruction (NBSRR) Model that estimates total escapement and total return for the Skeena and Nass Rivers [@EnglishEtAl2017SkeenaSockeyeInriver; @EnglishEtAl2004AssessmentCanadianAlaskan]. Specifically, we used fields `TE` (Total Escapement) and `Total run` for Area 3 sockeye from the  2022 update to the North and Central Coast (NCC) Salmon Database Version 2, maintained by LGL Ltd. with support from PSF [@EnglishEtAl2016NorthCentralCoast; @EnglishEtAl2018NorthCentralCoast; @ChallengerEtAl2018NorthCentralCoast].

The index of Nass steelhead spawner abundance and total return are for the Nass Summer CU, developed in collaboration with the Nisga’a Fish and Wildlife Department and LGL Ltd. [@EnglishEtAl2023PreliminaryAreaSalmon]. There is another steelhead CU in the Nass region - Nass Winter - which is not well monitored and therefore not included in our index of spawner abundance.

### Skeena

Chinook spawners were taken from the [PSC's Chinook Technical Committee (CTC) data sets](https://www.psc.org/publications/technical-reports/technical-committee-reports/chinook/ctc-data-sets/) and are reported on in @CTC2023AnnualReportCatch. Specifically, Skeena River (Area 4) escapement is provided in Table B3 (field `Total Esc`). There is no total return for the Skeena River provided in the CTC data sets.

For Skeena chum salmon, we used escapement to Area 4 reported in Table 32 of @TCNB2023CanadaNorthernBoundary rather than expanding escapement from spawner surveys because surveys of indicator stream have been increasingly patchy over the last 30 years, making expansions uncertain.

Skeena coho and pink salmon were expanded from available spawner surveys, as described below in [Expansion Factors](#expansion-factors). Note that the designation of indicator streams for the Skeena region was based on @EnglishEtAl2018NorthCentralCoast rather than the indicator designation in NuSEDS.

Skeena sockeye escapement and total return were derived from the Northern Boundary Sockeye Run Reconstruction (NBSRR) Model that estimates total escapement and total return for the Skeena and Nass Rivers [@EnglishEtAl2017SkeenaSockeyeInriver; @EnglishEtAl2004AssessmentCanadianAlaskan]. Specifically, we used fields `TE` (Total Escapement) and `Total run` for Area 4 sockeye from the  2022 update to the North and Central Coast (NCC) Salmon Database Version 2, maintained by LGL Ltd. with support from PSF [@EnglishEtAl2016NorthCentralCoast; @EnglishEtAl2018NorthCentralCoast; @ChallengerEtAl2018NorthCentralCoast].

The index of Skeena steelhead spawner abundance is derived from estimated escapement of Skeena Summer steelhead at the Tyee Test Fishery (1956 - present), provided by the Province via email. As for other regions, these estimates may not capture winter-run steelhead, for which data are not available.

### Central coast

Estimates of spawner abundance for all salmon species on the Central Coast were expanded from available spawner surveys, as described below in [Expansion Factors](#expansion-factors). Note that the designation of indicator streams for the Central Coast region was based on @EnglishEtAl2018NorthCentralCoast rather than the indicator designation in NuSEDS.

There are two spawner surveys for Steelhead trout on the Central Coast that we report in the Pacific Salmon Explorer. However, these surveys have been patchy through time with the most recent estimates from 2016. Therefore, spawner abundance and total return for Central Coast steelhead was considered unknown.

### Vancouver Island & Mainland Inlets

Estimates of spawner abundance for all salmon species and steelhead in Vancouver Island & Mainland Inlets were expanded from available spawner surveys, as described below in [Expansion Factors](#expansion-factors). We began the time series of spawner abundance for this region in 1953 because earlier years had high expansion factor values indicating lack of monitoring on key indicator streams. We are exploring the potential use of well-monitored Chinook indicator stocks to inform an index of spawner abundance and total return for Chinook [@CTC2023AnnualReportCatch].

### Fraser

<!-- River-level spawner abundance for Fraser Chinook found in NuSEDS can be highly unreliable, thus we based our expansions on only the most intensively monitored streams that have been deemed as reliable estimates of abundance by @BrownEtAl20202020SummaryAbundance. These streams are those shown in the [Pacific Salmon Explorer](https://www.salmonexplorer.ca), and the associated data can be accessed from the stream survey data in the [SWP Data Library](https://data.salmonwatersheds.ca/result?datasetid=1). We also truncated the Chinook index of abundance to 1984 and more recent data, as earlier years have been deemed unreliable [@BrownEtAl20202020SummaryAbundance] and from 1984 onward spawner estimates mirrored those reported by @AtlasEtAl2023TrendsChinookSalmon. For Chinook total return, we used the sum of total run for four Fraser populations (Harrison, Nicola, Lower Shuswap, and South Thompson - all) reported in @AtlasEtAl2023TrendsChinookSalmon and available from the associated [GitHub repository](https://github.com/willatlas/ChinookEscapement-RunSize). -->

Escapement of Fraser Chinook is provided in the [PSC's Chinook Technical Committee (CTC) data sets](https://www.psc.org/publications/technical-reports/technical-committee-reports/chinook/ctc-data-sets/) and are reported on in @CTC2023AnnualReportCatch. We took the sum of escapement to indicator stocks in Table B6 (all Spring/Summer, Harrison, Lower Shuswap, Nicola, Lower Chilcotin, and Chilko) as an index of spawner abundance. Catch of Fraser Chinook is provided in Table A14 but cannot be directly added to indicator escapement to yield total return.  PSF is pursuing Chinook run reconstruction output for the Fraser to inform total return.

Fraser chum catch and escapement are reported by PSC's Chum Technical Committee [@20232019PostSeasonSummary], however the most recently published report only contains estimates for 2010-2019 and the data were not otherwise made available to us. As such, we estimated spawner abundance from available spawner surveys in NuSEDS as described below in [Expansion Factors](#expansion-factors). We note that, although most NuSEDS data was updated to include surveys in 2022, for Fraser chum the most recent data was from 2020.

For interior Fraser coho CUs, spawner abundance and total return were provided by DFO on data request (pers. comm. Marissa Glavas, Data Manager, Fraser River Stock Assessment). We report total return as the sum of "Total Pre-Fishery Abundance" to all CUs and spawner abundance as the sum of "Total Return" (i.e., final spawner estimate plus fish removed from the system by DFO Salmon Enhancement Program or First Nations) to all CUs (we note the term "total return" is used differently in this data set to represent spawners!). We recognize that using these estimates ignores coastal coho populations, for which monitoring has been patchy through time.

Data on total return and spawner abundance of pink salmon and sockeye salmon in the Fraser region are provided by the PSC and accessed through the Fraser Panel Annual Report: Data Application [@PacificSalmonCommission2024PSCAnnualReport]. Total escapement for Fraser sockeye was not yet available for 2023, and 2023 total return is considered preliminary. We note that Fraser River pink salmon are only counted in the dominant, odd-year run. 

Steelhead trout in the Fraser are monitored by the Province in at least 10 different streams, but these data are not readily available. Relatively reliable estimates of steelhead spawner abundance are available at the CU-level for interior Fraser steelhead from the Thompson Summer CU (monitored at the Thompson River) and Mid Fraser Summer CU (primarily monitored at the Chilcotin River; data in the [Pacific Salmon Explorer](https://salmonexplorer.ca)). We used the sum of CU-level spawner abundance for these two CUs as an index of Fraser steelhead abundance. We note that this approach does not include more coastal populations, such as the Lower Fraser Summer steelhead monitored in the Coquihalla River or Boundary Bay Winter steelhead, which may not have declined to the same extent over the past decade. However, a lack of publicly accessible data on coastal Fraser steelhead has limited our ability to include these CUs in our index of abundance.

### Columbia

We used CU-level estimates of spawner abundance (run reconstructions) sourced from DFO (Ogden, pers. comm.) for Chinook and @StockwellHyatt2003SummaryOkanaganSockeye and subsequent updates for sockeye. 

There is no monitoring of steelhead trout in the Canadian portion of the Columbia region, but the Okanagan Nation Alliance does enumerate steelhead in akskwəkwant (Inkaneep Creek) and estimate a Canadian portion of steelhead spawning abundance. These data can be found in associated report (e.g. @OBMEP2022ColumbiaSteelhead) and are available in the Pacific Salmon Explorer as the CU-level spawner abundance for the Mid Columbia Summer CU.

## Expansion Factors 

For species and regions that lacked reliable data on spawner abundance and total return at the appropriate scale, we estimated regional-scale abundance from stream-level surveys. We started with spawner survey data shown in the [Pacific Salmon Explorer](https://www.salmonexplorer.ca). Spawner surveys were each assigned to one of the nine regions we considered based on their geographic location. We note that this is slightly different from how spawner survey data are organized in the Pacific Salmon Explorer, where data are organized by Conservation Units (CUs) that may span regional boundaries (e.g. for pink salmon that have relatively geographically large CUs). In cases of trans-regional CUs, the spawner surveys appear in both regions in the Pacific Salmon Explorer, whereas here we assign spawner surveys to the region in which they fall geographically, regardless of the CU boundary. 

Spawner survey data are largely derived from river-level estimates in  DFO’s [New Salmon Escapement Database System (NuSEDS)](https://open.canada.ca/data/en/dataset/c48669a3-045b-400d-b730-48aafe8c5ee6), but are cleaned up to address issues of, for example, inconsistent naming of streams through time or duplicate data. The spawner survey abundance is equal to the `MAX_ESTIMATE` in NUSEDS for each year and river population, calculated as the maximum of all fields containing spawner abundance data (e.g. natural adult spawners, natural jack spawners, total broodstock removals). Each of these river populations has been designated as an **indicator** stream or **non-indicator**. Indicator streams are observed more consistently in recent decades, tend to have higher spawner abundance, and tend to be monitored using more intensive methods that provide greater accuracy [EnglishEtAl2016NorthCentralCoast]. For further information on the compilation of spawner survey data, see the [Pacific Salmon Explorer Technical Report](https://bookdown.org/salmonwatersheds/tech-report/analytical-approach.html#spawner-surveys).

Expansion Factor 1, $F_{1,y/d}$, expands the observed spawner abundances in indicator streams to account for indicator streams that are not monitored in a given year. It is calculated for each year $y$ of the spawner time series, and relies on a decadal contribution of each indicator stream to the total escapement to all indicator streams, $P_{d,i}$ in decade $d$ [EnglishEtAl2016NorthCentralCoast]. The calculation of this decadal contribution requires at least one estimate from each indicator stream for the decade. If a decade does not contain sufficient information (i.e. one or more indicator streams are not monitored at all in a decade), then a reference decade is used to calculate $P_{d,i}$. This reference decade is chosen to be: (1) the closest decade (historical or future) with sufficient information, or failing (1), (2) the 20-year period from 1980-1999 [@ChallengerEtAl2018NorthCentralCoast].

For each decade (or reference decade if insufficient information) $d$, the average number of spawners returning to indicator stream $i$ is calculated as:

$$\bar{S}_{d,i} = \sum_{y = 1}^{Y_{d,i}} \frac{\hat{S}_{y/d, i}}{Y_{d,i}} $$
where $Y_{d,i}$ is the number of years for which spawner estimates are available within decade $d$ for stream $i$.  From the average number of spawners for all indicator streams, the decadal proportional contribution of each indicator stream is calculated as:

$$P_{d,i} = \frac{\bar{S}_{d,i}}{\sum_{i=1}^{I} \bar{S}_{d,i}}$$
where $I$ is the total number of indicator streams.

Expansion Factor 1 is then calculated for each year within the decade $y/d$ based on the decadal contributions and which streams were monitored or not in a given year:

$$F_{1,y/d}=\left( \sum_{i=1}^I P_{d,i} w_{y/d,i} \right)$$
where $w_{y/d,i}$ is 1 if stream $i$ was monitored in year $y$ and 0 if stream $i$ was not monitored in year $y$. Expansion Factor 1 is then multiplied by the sum of the observed spawners in all indicator stream to yield the expanded estimate of spawner abundances in all indicator streams in the region:

$$S'_{y} = F_{1,y/d} \sum_{i=1}^I \hat{S}_{y,i}$$

Expansion Factor 2 $F_{2,d}$ expands the spawner abundance to all indicator streams, $S'_{y}$, to account for non-indcator streams. Unlike Expansion Factor 1, this is calculated for each decade (rather than each year) and then applied to all years within a decade. Like Expansion Factor 1, there needs to be sufficient information within the given decade in order to calculate $F_{2,d}$, or else a reference decade is chosen. See @EnglishEtAl2016NorthCentralCoast for detailed on how reference decades are chosen in that case.

Expansion Factor 2 is calculated as:

$$F_{2,d} = \frac{\sum_{i = 1}^I \bar{S}_{d,i} + \sum_{j = 1}^{J} \bar{S}_{d,j}}{\sum_{i = 1}^I \bar{S}_{d,i}}$$
where $\bar{S}_{d,i}$ and $\bar{S}_{d,j}$ are the deacdal average number of spawners in indicator and non-indicator streams, respectively, calculated above.  $J$ is the total number of non-indicator streams.  The adjusted total number of spawners in both indicator and non-indicator streams is then calculated as:
$$ S''_{y} = F_{2,d} S'_{y} $$

Note that when expanding spawner abundance for spawner-recruit analysis, a third expansion factor is applied to account for streams that are never monitored and for observer (in)efficiency [@PeacockEtAl2020EvaluatingConsequencesCommon]. We did not apply this third expansion factor because it is highly undertain and we are interested in relative changes in abundance through time, so we do not require to expand to absolute abundance.

## Smoothing
We smoothed time series of spawner abundance and total return using a right-aligned running geometric mean over the length of a generation. This reduces the influence of dominant years and produces an index that is less sensitive to stochastic interannual variability that is common in salmon population dynamics. The generation length was based on the dominant life-history type for each species in a particular region. The smoothed spawner abundance in year $y$ given a generation length $g$ was calculated as:
$$ \bar{S_{y}} = \left( \prod_{t = y-g+1}^y {S''_t} \right)^{1/g} $$

We smoothed abundance from the first year to the most recent year of raw abundance data. If there were intermediate years with missing data, the smoothed abundance was still calculated using the available years (i.e. ignoring the missing data, with the exponent $1/g$ adjusted so that $g$ reflected the number of years with data in the generation). If all years in a generation were missing data, than the smoothed abundance was `NA`.

When plotting, we show the smoothed abundance relative to the long-term historical average, so that species that have vastly different abundances within a region can be plotted on the same y-axis for comparison.

## Quantifying change
We summarize the time series of smoothed spawner abundance or total return at the regional scale using three different metrics:

1. **Current status** relative to historical average;
2. **Long-term trend** over the entire time series; and
3. **Short-term trend** over the most recent three generations.

The currents status provides information on how the most recent spawner abundance compares to past values, while the two trend metrics provide information on the average direction of change and are less sensitive to the magnitude of current abundance.

The **current status** relative to historical average is calculated as:
$$ (\bar{S_{y}} - \bf{S}) / \bf{S} $$
where $y$ is the most recent year for which the index of spawner abundance could be calculated and $\bf{S}$ is the average smoothed spawner abundance over the entire time series.

The **long-term trend** is calculated following the recommendations of @DEon-EggertsonEtAl2015ReliableIdentificationDeclining, who found that the correct identification of declines in salmon population abundance may be most reliable when considering the entire time series, and applying regression-based estimates of change calculated from log-transformed and smoothed spawner abundances. As such, we fit a simple linear model to the time series of $\log ( \bar{S}_{y} )$ over $y$. The resulting slope, $m$, gives an average estimate of annual change:

$$ m = \log \left( \frac{\bar{S}_{y}}{\bar{S}_{y-1}} \right)$$.

With some rearranging, we can calculate the average annual percent change as:
$$ \frac{\bar{S}_{y} - \bar{S}_{y-1}}{\bar{S}_{y-1}} = \frac{ e^m \bar{S}_{y-1} - \bar{S}_{y-1}}{\bar{S}_{y-1}} = e^m - 1$$.
If the slope $m$ is not significantly different from zero ($p \geq 0.05$), then the trend is classified as "stable" regardless of the magnitude of the estimated slope. If the slope is significantly different from zero ($p < 0.05$), then the trend is classified as increasing if $m > 0$ or decreasing if $m < 0$.

The **short-term trend** is calculated as described above, but only using the time series over the most recent three generations.

```{r, echo = FALSE, include = TRUE, fig.width = 8, fig.height = 3.5, fig.cap = "**Above:** Simulated time series of spawner abundance (grey line), smoothed with a running geometric mean over the generation length (4 years; black line). The three metrics are illustrated: **Current status** relative to historical average (black);  **Long-term trend** over the entire time series (green); and **Short-term trend** over the most recent three generations (clay). The shaded regions of the regression lines indicate the 95% prediction intervals. In this example, the short-term trend is not statistically significant (p > 0.05), and so the trend is characterized as 'stable' despite the negative slope."}

# Simulate time series over 72 years (1950 - 2021)
S <- numeric(72)
set.seed(23435543)
S[1] <- 12
for(i in 2:72){
	S[i] <- rlnorm(n = 1, meanlog = log(S[i-1] * exp(1.3 - S[i-1]/seq(14, 10, length.out = 72)[i])), sd = 0.2)
}
S[72] <- 12

g <- 4 # generation length
SS <- numeric(72)
for(i in 1:72){
	SS[i] <- prod(S[max(1, (i - g + 1)):i])^(1/length(max(1, (i - g + 1)):i))
}

# Plot
par(mfrow = c(1,1), mar = c(4,4,2,1), cex.lab = 1)

# Current status relative to historical average
plot(1950:2021, SS, "n", bty = "l", las = 1, ylab = "Spawner abundance (thousands)", xlab = "", ylim = c(10, 22))
lines(1950:2021, S, col = SWP_cols['stone1'])
abline(h = mean(SS), lty = 2, col = SWP_cols['stone3'])
points(2021, SS[72], pch = 21, bg = SWP_cols['stone1'], cex = 2)
arrows(2021, mean(SS), 2021, SS[72], lwd = 2, col = 1, length = 0.08)
text(2018, mean(SS), paste0("Current status:\n", round((SS[72] - mean(SS))/SS[72]*100, 1), "%"), col = 1, pos = 3, xpd = NA, font = 2)
# mtext(side = 3, adj = 0, "  a) Current status relative to historical average", cex = 0.8)

# 2. Change over the entire time series
fit <- lm(log(SS) ~ c(1950:2021))
predSS <- predict(fit, se.fit = TRUE)

# plot(1950:2021, SS, "l", bty = "l", lwd = 1.5, las = 1, ylab = "Spawner abundance (thousands)", xlab = "")
polygon(x = c(1950:2021, rev(1950:2021)),
        y = c(exp(predSS$fit - 1.96*predSS$se.fit), rev(exp(predSS$fit + 1.96*predSS$se.fit))),
        border = NA, col = paste0(SWP_cols['tidal2'], 30))
lines(1950:2021, exp(predSS$fit), col = SWP_cols['tidal2'], lwd = 2)

text(1992, 18, paste0("Long-term trend: ", round(coefficients(fit)[2]*100, 1), "% per year (declining)"), col = SWP_cols['tidal2'], xpd = NA, font = 2)
# mtext(side = 3, adj = 0, "  b) Long-term trend over the entire time series", cex = 0.8)

# 2. Change over 3 gens
fit2 <- lm(log(SS[(72 - 3*g + 1):72]) ~ c(1950:2021)[(72 - 3*g + 1):72])
predSS2 <- predict(fit2, se.fit = TRUE)

polygon(x = c(c(1950:2021)[(72 - 3*g + 1):72], rev(c(1950:2021)[(72 - 3*g + 1):72])),
        y = c(exp(predSS2$fit - 1.96*predSS2$se.fit), rev(exp(predSS2$fit + 1.96*predSS2$se.fit))),
        border = NA, col = paste0(SWP_cols['clay1'], 50))
lines(c(1950:2021)[(72 - 3*g + 1):72], exp(predSS2$fit), col = SWP_cols['clay1'], lwd = 2)
text(2007, 11, paste0("Short-term trend: ", round(coefficients(fit2)[2]*100, 1), "% per year (stable)"), col = SWP_cols['clay1'], xpd = NA, font = 2)

lines(1950:2021, SS, lwd = 1.5)
```

### Additional Considerations
The standardized approach to quantifying change described above was applied across regions and species. We then considered two additional attributes prior to reporting on the State of Salmon:

1. If the species and region had no data in the most recent generation, the current status was "Unknown" even if historical abundance information was available. This was the case for **Haida Gwaii Chinook**, for which there were no reliable estimates of spawners since 2006.

2. If the time series of abundance (spawners or total return) contained fewer than 20 years of data, we could not reliably establish a historical baseline and the current status was therefore "Unknown". This applied to **Columbia Chinook** and **Columbia steelhead**, both of which have been monitored since 2006.

<!-- 2. If there was reliable information that the absolute population size was < 1000 spawners, then the species and region was considered at risk of extirpation regardless of the outcome of the metrics above. This was the case for **Columbia Chinook** which have been assessed as Endangered by COSEWIC due to low population size [@COSEWIC2017ChinookSalmonOncorhynchus]. There were four other regions and species that had spawner abundance < 1000, but none of these had reliable estimates of **absolute** spawner abundance and all four were already assessed as having current abundance 85% to 96% below historical average. -->

# Results 

:::: {.blackbox data-latex=""}
::: {.center data-latex=""}
**NOTICE!**
:::

**These are PRELIMINARY results and the following figures should not be taken as a statement on the status of salmon in these regions.** At this time, we are working to verify datasets and refine our methods.
::::



```{r, echo = FALSE, message = FALSE, warning = FALSE}
# library(viridis)
library(reactable)
library(reactablefmtr)
library(dplyr)
library(abind)
library(tools)

# Read in data for plots

sps_dat <- read.csv("output/sps-data.csv")
sps_metrics <- read.csv("output/sps-metrics.csv")

regions <- unique(unique(sps_dat$region))

# Source script with code for plotting functions
source("code/functions.R")

```

* These trends in aggregated spawner abundance provide a broad overview of how salmon are doing, but must be interpreted with caution due to the diversity of populations with potentially different outlooks within each region and species. For example, Chinook in Vancouver Island & Mainland Inlets have an aggregate spawner abundance that is `r round(sps_metrics$current_status[sps_metrics$region == "Vancouver Island & Mainland Inlets" & sps_metrics$species == "Chinook" & sps_metrics$type == "Spawners"]*100, 1)`% above historical average, but some stocks (e.g., West Coast Vancouver Island) are of conservation concern. Preserving the population diversity within regions is key to the long-term resilience of salmon, particularly in the face of climate change.
* The status of spawner abundance is, in most cases, more positive than the status in total return, highlighting that declines in fisheries have been pervasive. 

## All regions

**Highlights**

* Across regions, pink and sockeye salmon seem to be doing the best (spawner abundance above historical average for over half of the regions assessed) and steelhead and chum are doing the worst (spawner abundance below historical average in almost all regions assessed).
* The Fraser region has the most positive outlook, with spawner abundances of chum, coho, pink, and sockeye all above historical average. Although the historically productive fisheries supported by this Region have been decimated, total return for coho and pink are now above below historical average, and short-term trends in both spawner abundance and total return for these species are stable, providing hope that declines can be stemmed and populations rebuilt.
* Further north, in the Yukon and Transboundary, almost all species (with the exception of Transboundary sockeye salmon) are well below historical average with recent declines in either spawners, total return, or both. This finding is concerning, given that climate change may render southern habitats less suitable for salmon into the future and more northern populations must be nurtured as potential strongholds. Management of salmon harvest in these northern regions is complex, and involves international treaties that are not easily negotiated or adapted in response to environmental changes or emerging trends, challenging efforts to stem declines and recover these populations.

**Below**: Summary of current status of both spawner abundance and total return across regions and species. Regions and species below historical average are in red and above historical average are in green. Black cells indicate species that are not thought to be present in the given region, and grey cells indicate status was Unknown. 
```{r, echo = FALSE, message = FALSE, warning = FALSE}
btn_table.all()
```


## Yukon

**Highlights**

* Chinook and chum salmon spawners have both experienced precipitous declines in recent years.
* Trends in Chinook total return show statistically significant declines of 3% and 4% **per year** over long and short time frames, respectively, highlighting the significant, persistent decline that has led to closure of fisheries, including First Nations subsistence fishing, throughout in the Canadian portion of the Yukon.   
* Accompanying declines in **abundance**, there is also evidence that Yukon Chinook body size and reproductive capacity have been reduced [@OhlbergerEtAl2020ReproductiveValueLarge].
* These shifts in quality of escapement, combined with warming rivers during spawning migrations and shifting ocean conditions with climate change, may continue to challenge recovery efforts for Yukon salmon [@SchoenEtAl2023NOAAArcticReport].

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Yukon",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Yukon",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Yukon",
  sps_metrics = sps_metrics
)
```

## Transboundary

**Highlights**

* Most species in the Transboundary are below historical average spawner abundance, except sockeye salmon which have shown a recent increase, driven by increases in river-type type sockeye in the Taku River.
* As in many other regions, the most recent index of spawner abundance is lower than the index of total return for the three Transboundary species that have both types of data (Chinook: `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Chinook" & sps_metrics$type == "Spawners"]*100, 1)`% compared to `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Chinook" & sps_metrics$type == "Run Size"]*100, 1)`%, coho: `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Coho" & sps_metrics$type == "Spawners"]*100, 1)`% compared to `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Coho" & sps_metrics$type == "Run Size"]*100, 1)`%, and sockeye: `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Spawners"]*100, 1)`% compared to `r round(sps_metrics$current_status[sps_metrics$region == "Transboundary" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Run Size"]*100, 1)`%), indicating that **declines in catch** have also occurred in recent years.


```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Transboundary",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Transboundary",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Transboundary",
  sps_metrics = sps_metrics
)
```

## Haida Gwaii

**Highlights**

* All species for which we had reliable data are currently below their historical average, with long-term trends either stable or declining.
* Unlike in other regions, where pink salmon have been doing relatively well, pink salmon have shown the most dramatic declines, and most recent spawner abundance was `r -round(sps_metrics$current_status[sps_metrics$region == "Haida Gwaii" & sps_metrics$species == "Pink" & sps_metrics$type == "Spawners"]*100, 1)`% **lower** than the historical average.
* There is only one indicator stream for Chinook in Haida Gwaii,the Yakoun River, which has not been monitored since 2006 and although abundance was relatively high at that time, current status is unknown.

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Haida Gwaii",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Haida Gwaii",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Haida Gwaii",
  sps_metrics = sps_metrics
)
```

## Nass

**Highlights**

* While most species show declines over both long- and short-time frames, Nass pink and coho salmon have rebounded to above historical average abundance in the most recent generation with positive long-term trends.
* Chum salmon are the species furthest below their historical average (`r round(sps_metrics$current_status[sps_metrics$region == "Nass" & sps_metrics$species == "Chum" & sps_metrics$type == "Spawners"]*100, 1)`%) with an average long-term decline of `r round(sps_metrics$long_trend[sps_metrics$region == "Nass" & sps_metrics$species == "Chum" & sps_metrics$type == "Spawners"]*100, 1)`%.
* Although sockeye total return is `r -round(sps_metrics$current_status[sps_metrics$region == "Nass" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Run Size"]*100, 1)`% **below** historical average with concerning negative short- and long-term trends, increases over the last two years have put **spawner abundance** above historical average with an increasing short-term trend over the most recent three generations. 

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Nass",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Nass",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Nass",
  sps_metrics = sps_metrics
)
```

## Skeena

**Highlights**

* Most species are below historical average spawner abundance, with chum salmon having declined by `r -round(sps_metrics$current_status[sps_metrics$region == "Skeena" & sps_metrics$species == "Chum" & sps_metrics$type == "Spawners"]*100, 1)`%. Exceptons include sockeye spawner abundance, which has recently increased to `r round(sps_metrics$current_status[sps_metrics$region == "Skeena" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Spawners"]*100, 1)`% above historical average in 2022 and pink salmon which were `r +round(sps_metrics$current_status[sps_metrics$region == "Skeena" & sps_metrics$species == "Pink" & sps_metrics$type == "Spawners"]*100, 1)`% in 2022.
* Total return was only available for Skeena sockeye, and shows increases in the 1980s and 90s, with a decline from the peak in 1996. Slight increases over the last two years put current total return `r -round(sps_metrics$current_status[sps_metrics$region == "Skeena" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Run Size"]*100, 1)`% below historical average, with stable long-term and short-term trends. Other research has found that the decline in sockeye abundance from the 1980s has been accompanied by erosion of diversity, with enhanced stocks increasingly dominating returns [@PriceEtAl2021PortfolioSimplificationArising].
* Estimates of regional spawner abundance have become increasingly uncertain since 2000, especially for coho, due to a decline in monitoring of indicator streams.

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Skeena",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Skeena",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Skeena",
  sps_metrics = sps_metrics
)
```


## Central Coast

**Highlights**

* All species are below historical average abundance, with dramatic declines of culturally and economically important sockeye, Chinook, and chum salmon.
* Pink salmon, which tend to fluctuate in abundance more than other species, have increased only recently from an all-time low in 2019, more than doubling between 2019 and 2021.
* Expansion factors for regional-scale reconstructions have increased substantially since the mid-2000s, with a decline in monitoring creating uncertainties in our results for all species, but especially coho, sockeye, and Chinook.

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Central Coast",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Central Coast",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Central Coast",
  sps_metrics = sps_metrics
)
```


## Vancouver Island & Mainland Inlets

**Highlights**

* Most species are currently below historical average, with the exception of Chinook and pink salmon.
* Aggregate Chinook abundance is `r round(sps_metrics$current_status[sps_metrics$region == "Vancouver Island & Mainland Inlets" & sps_metrics$species == "Chinook" & sps_metrics$type == "Spawners"]*100, 1)`% above historical average, but some populations have concerning declines (e.g., West Coast Vancouver Island Chinook are at low enough abundance to have triggered a Recovery Potential Assessment in recent years) while others are increasing - including Cowichan River which has seen consistent increases in spawner abundance **and total return** since 2010 [@AtlasEtAl2023TrendsChinookSalmon]. 
* Coho were below average and declining - poor outcomes under all 3 metrics.
* Short-term trends are stable or increasing for Chinook, pink, and sockeye, suggestion possibility for recovery.
* Dynamics through time are more stable for the regional aggregate because there are many component populations in this large area, but some local trends are concerning highlighting a need to understand and conserve the diversity represented by component populations (for more detailed information on populations within regions, see the [Pacific Salmon Explorer](https://www.salmonexplorer.ca)).

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Vancouver Island & Mainland Inlets",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Vancouver Island & Mainland Inlets",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Vancouver Island & Mainland Inlets",
  sps_metrics = sps_metrics
)
```

## Fraser

**Highlights**

* Despite the uptick in Fraser sockeye spawner abundance in the early 2010s, the most recent spawner abundance and total return are below the devastating returns in 2009 that triggered a federal inquiry. The in-season estimate for Fraser sockeye total return in 2023 was `r -round(sps_metrics$current_status[sps_metrics$region == "Fraser" & sps_metrics$species == "Sockeye" & sps_metrics$type == "Run Size"]*100, 1)`% below historical average.
* Chinook spawner abundance and total return were below historical average with recent short-term declines. However some life-history types are doing better than others [@AtlasEtAl2023TrendsChinookSalmon], highlighting the need to conserve the within-species diversity that makes salmon resilient to environmental change.
* Spawner abundance of chum, coho, and pink salmon are above historical average, with total return slightly above average for pink and coho, with a stable trend in the most recent three generations providing some hope of recovery. Time series of chum salmon data should be interpreted with caution as they are based on expansion factors and spawner survey coverage has varied considerably through time. Total return is not (yet) available for chum salmon in the Fraser.

* Declines of Chinook, chum, pink, sockeye, and steelhead since the early 2000s may reflect the increasing pressures of climate change on these southern and interior populations.

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Fraser",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Fraser",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Fraser",
  sps_metrics = sps_metrics
)
```

## Columbia

**Highlights**

* The current status of Columbia Chinook and steelhead is categorized as Unknown because the are insufficient data to establish a meaningful baseline (fewer than 20 years; Chinook 2006-2022 and steelhead 2006-2021).
* Columbia Chinook and sockeye show promise of rebuilding, with positive long-term trends. 
* The time series for Chinook and steelhead are short, making it difficult to establish a meaningful baseline. For this reason, we show the current status relative to the historical average as "Unknown" for Columbia Chinook and steelhead.
* Although Chinook spawner abundance has increased from a low in 2011, the absolute abundance is still less than 1000 spawners and the Okanagan population of Chinook was listed as Endangered in 2017 by COSEWIC [@COSEWIC2017ChinookSalmonOncorhynchus]. Recent increases should be cautiously celebrated, knowing that this population is still at risk of extirpation.
* Columbia steelhead have declined precipitously since a peak spawner abundance in 2012.

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Spawner abundance through time as a percentage of the long-term average. Spawner abundance is smoothed using a one-generation geometric running average (right-aligned), and plotted relative to the historical average for each species. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Columbia",
	abund = "spawners", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```

```{r, echo = FALSE, include = TRUE, fig.width = 10, fig.height = 4, fig.cap = "**Above:** Total return through time as a percentage of the long-term average. Closed points highlight the most recent index of spawner abundance. The percent shown is the percent change from the historical average to the most recent year.", message = FALSE, warning = FALSE}
plot.regional_abund(
  selected_region = "Columbia",
	abund = "runsize", # Select "spawners" or "runsize"
	sps_metrics = sps_metrics, 
	sps_dat = sps_dat)

```


**Below:** Summary of the three metrics for spawners and total return. For long-term  trends and short-term  trends, the percentage is the average annual change calculated over the respective time period. Grey values indicate the % change was not significantly different from zero (i.e., stable), red values indicate declining trends, and green values indicate increasing trends.
```{r, echo = FALSE, include = TRUE, message = FALSE, warning = FALSE}

btn_table(
  selected_region = "Columbia",
  sps_metrics = sps_metrics
)
```



# References

<div id="refs"></div>

<!-- # Supplemental results -->

<!-- ## Expansion Factors -->

<!-- The following figures show the values of Expansion factors 1 (solid line) and 2 (dashed line) that were multiplied by the sum of observed spawners return to indicator stream to calculate the regional index of spawner abundance for each species. -->

<!-- ```{r, echo = FALSE, include = TRUE, fig.width = 8, fig.height = 4, fig.cap=""} -->
<!-- for(r in regions){ -->
<!--   plot.regional_expansion(selected_region = r, -->
<!--                        spawners = spawners, -->
<!--                        sp_cols = sp_cols) -->
<!-- } -->
<!-- ``` -->